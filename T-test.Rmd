---
title: "Statistical Report: Gapminder data set"
author: "Eldho Paul"
date: "`r Sys.Date()`"
output:
  html_document: 
    toc: true
    toc_float: true
    theme: darkly
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(patchwork)
library(dplyr)
library(gapminder)
library(forcats)
```

## Exploration

Gapminder Foundation is a non-profit venture registered in Stockholm, Sweden, that promotes sustainable global development and achievement of the United Nations Millennium Development Goals by increased use and understanding of statistics and other information about social, economic, and environmental development at local, national, and global levels.

The Gapminder data set that is in use for this report is on life expectancy, GDP per capita, and population by country.


### General summary

```{r}
summary(gapminder)
```
### Continental summary

```{r}
gapminder %>%
  group_by(continent) %>%
  summarise(
    Mean_LifeExp = mean(lifeExp, na.rm = TRUE),
    Median_LifeExp = median(lifeExp, na.rm = TRUE),
    StdDev_LifeExp = sd(lifeExp, na.rm = TRUE)
  )
```


### Life expectancy data distriibution


```{r lifeExp-distribution}
ggplot(gapminder, aes(x = lifeExp)) +
  geom_density(fill = "blue", alpha = 0.2) +
  labs(title = "Life Expectancy", x = "Life Expectancy", y = "Density")

```


## Independent T-Test


### Assumptions

Normality: The life expectancy data for both Ireland and Switzerland should be approximately normally distributed. 

Homogeneity of Variances: The variances of life expectancies in Ireland and Switzerland is roughly equal.

Independence of Observations: The life expectancy data for Ireland is independent of the data for Switzerland. 

Scale of Measurement: The life expectancy is measured at an interval or ratio scale.

Random Sampling: The population of Ireland and Switzerland has an equal chance of being included in the sample.

### Density Plot

```{r}
gapminder %>%
  #drop_na(country) %>%
  filter(country %in% c("Ireland","Switzerland"))%>%
  ggplot(mapping = aes(lifeExp, 
                              color=country,
                              fill = country))+
  geom_density(alpha=0.2)+
  theme_bw()+labs(title = "Life Expectancy", x = "Life Expectancy", y = "Density")
```




### Hypothesis 

H0: The mean life expectancy of Ireland is less than Switzerland

H1: The mean life expectancy of Ireland is not less than Switzerland
                    

### life expectancy SD & Var

```{r}
 gapminder %>%
  filter(country %in% c("Ireland", "Switzerland")) %>%
  group_by(country) %>%
  summarise(
    sd_lifeExp = sd(lifeExp, na.rm = TRUE),
    var_lifeExp = var(lifeExp, na.rm = TRUE))
```

### T-test

```{r}
gapminder %>%
  filter(country %in% c("Ireland", "Switzerland")) %>%
  t.test(lifeExp~ country, data = .,
         alternative = "less",
         conf.level=0.95)
```
### Reflection

Seeing from the results above, it can be said that null hypothesis cannot be rejected as our assumption is not statistically significant and that it might as well be that they might as well have almost the same mean life expectancy.

## Paired T-Test

### Assumptions

Paired Observations: The data must consist of matched pairs — in this case, life expectancy values in African countries in 1957 paired with their corresponding values in 2007.

Normality of Differences: The differences in life expectancy between the two years (2007 - 1957) for each African country is approximately normally distributed.

Independence of Pairs: Each pair (country’s life expectancy in 1957 and 2007) is independent of the other pairs.

Scale of Measurement: The life expectancy is measured on an interval or ratio scale.

Random Sampling: The African countries included does represent a random sample of a larger population.

### Density Plot

```{r}

gapminder %>%
  filter(continent == "Africa" & (year == 1957 | year == 2007)) %>%
  ggplot(mapping = aes(x = lifeExp, color = factor(year), fill = factor(year))) +
  geom_density(alpha = 0.2) +
  theme_bw() +
  labs(color = "Year", fill = "Year")+labs(title = "Life Expectancy in Africa", x = "Life Expectancy", y = "Density")
```

### Hypothesis


H0: The mean life expectancy of Africa in 1957 is not same as Africa in 2007

H1: The mean life expectancy of Africa in 1957 is same as Africa in 2007
                    

### life expectancy SD & Var:

```{r}
 gapminder %>%
  filter(continent == "Africa" & (year == 1957 | year == 2007)) %>%
  group_by(year) %>%
  summarise(
    sd_lifeExp = sd(lifeExp, na.rm = TRUE),
    var_lifeExp = var(lifeExp, na.rm = TRUE)
  )
```

### Paired t-test

```{r}
 gapminder %>%
  filter(year %in% c(1957,2007)& 
           continent=="Africa") %>%
  mutate(year = factor(year,levels=c(2007,1957))) %>%
  t.test(lifeExp~year,data=.,
         paired = TRUE)
```
### Reflection

From the above result, we can reject our null hypothesis since our assumption has statistical significance. We

## Anova

### Assumptions 

Normality: The life expectancy data for each continent (Americas, Europe, Asia) is approximately normally distributed.

Homogeneity of Variances: The variances of life expectancy across these continents is similar.

Independence of Observations: The life expectancy data for each continent is independent of the others. 

Random Sampling: The data for each continent does represent a random sample from the respective continental populations.

Interval or Ratio Level Data: The life expectancy data is measured at an interval or ratio scale.

Independence of Groups: The groups (continents) is mutually exclusive.

### Mean life expectancy 

```{r }
gapdata <- gapminder %>%
  filter(year == 2007 &
           continent %in% c("Americas", "Europe", "Asia")) %>%
  select(continent, lifeExp)
```

```{r }
gapdata %>%
  group_by(continent) %>% 
  summarise(Mean_life= mean(lifeExp)) %>%
  arrange(Mean_life)
```


### Research question 

Is the life expectancy in these three continents different?

### Hypothesis

H0: Mean life expectancy is the same 
H1: Mean life expectancy is not the same

```{r}
gapminder%>%
  filter(continent %in% c("Americas", "Europe", "Asia")) %>%
  group_by(continent) %>%
  summarize(sd = sd(lifeExp, na.rm = TRUE),
            variance = var(lifeExp, na.rm = TRUE))
```


### Anova result
```{r }
gapdata  %>%
  aov(lifeExp~continent, data=.) %>%
  summary()
 
```




### Tukey comparison

```{r }
gapdata  %>%
  aov(lifeExp~continent, data=.) %>%
  TukeyHSD()
 
```

### Reflection

From the 1st results above, we can see that the probability that we can see a difference is very small : 3.42e-05, So we reject the null hypothesis.
Using the Tukey comparison we can see the combination of continents and see that with respect to Asia-Americas we have the probability p adj 0.1432 and shows statistical significance that there might exist no difference.
But the other two combination shows no statistical significance and so difference exists

## Linear regression

### Scatter Plot

```{r message=FALSE, warning=FALSE}
ggplot(gapminder, aes(x = gdpPercap, y = lifeExp)) +
  geom_point(color = "#89CFF0") +
  geom_smooth(method = "lm", color = "red") +  # Adding a linear regression line
  facet_wrap(~ continent) +
  labs(title = "Scatter Plot of Life Expectancy vs GDP per Capita by Continent with Regression Line",
       x = "GDP per Capita",
       y = "Life Expectancy") +
  theme_minimal()
```



### Scatter Plot(EU)

```{r message=FALSE, warning=FALSE}
ggplot(gapminder %>% filter(continent %in% c("Europe")), 
       aes(x = gdpPercap, y = lifeExp)) +
  geom_point(color = "#89CFF0") +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~ continent) +
  labs(title = "Life Expectancy vs GDP per Capita in Europe",
       x = "GDP per Capita", y = "Life Expectancy") +
  theme_minimal()
```


### Hypothesis

H0: There is no upward or downward relation between Life expectancy and independent GDP per capita in EU

H1: There is a relation between Life expectancy and independent GDP per capita in EU

### Linear model result

```{r }
europe_data <- gapminder[gapminder$continent == "Europe", ]
lm_model_europe <- lm(gdpPercap ~ lifeExp, data = europe_data)
summary(lm_model_europe)
```

### Reflection

The null hypothesis is not statistically significant( p<2e-16) and hence is rejected. We find a relation between both the variables and we can agree the slope seen in the linear model.