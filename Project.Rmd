---
title: "Statistical Report: Gapminder data set"
author: "Eldho Paul"
date: "`r Sys.Date()`"
output:
  html_document: 
    toc: true
    toc_float: true
    theme: darkly
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(patchwork)
library(dplyr)
library(gapminder)
library(forcats)
```

## Exploration

Gapminder Foundation is a non-profit venture registered in Stockholm, Sweden, that promotes sustainable global development and achievement of the United Nations Millennium Development Goals by increased use and understanding of statistics and other information about social, economic, and environmental development at local, national, and global levels.

The Gapminder data set that is in use for this report is on life expectancy, GDP per capita, and population by country.


### General summary

```{r}
summary(gapminder)
```
### Continental summary

```{r}
gapminder %>%
  group_by(continent) %>%
  summarise(
    Mean_LifeExp = mean(lifeExp, na.rm = TRUE),
    Median_LifeExp = median(lifeExp, na.rm = TRUE),
    StdDev_LifeExp = sd(lifeExp, na.rm = TRUE)
  )
```


### Life expectancy data distriibution


```{r lifeExp-distribution}
ggplot(gapminder, aes(x = lifeExp)) +
  geom_density(fill = "blue", alpha = 0.2) +
  labs(title = "Life Expectancy", x = "Life Expectancy", y = "Density")

```


## Independent T-Test


### Assumptions

Normality: The life expectancy data for both Ireland and Switzerland should be approximately normally distributed. 

Homogeneity of Variances: The variances of life expectancies in Ireland and Switzerland is roughly equal.

Independence of Observations: The life expectancy data for Ireland is independent of the data for Switzerland. 

Scale of Measurement: The life expectancy is measured at an interval or ratio scale.

Random Sampling: The population of Ireland and Switzerland has an equal chance of being included in the sample.

### Density Plot

```{r}
gapminder %>%
  #drop_na(country) %>%
  filter(country %in% c("Ireland","Switzerland"))%>%
  ggplot(mapping = aes(lifeExp, 
                              color=country,
                              fill = country))+
  geom_density(alpha=0.2)+
  theme_bw()+labs(title = "Life Expectancy", x = "Life Expectancy", y = "Density")
```




### Hypothesis 

H0: The mean life expectancy of Ireland is less than Switzerland

H1: The mean life expectancy of Ireland is not less than Switzerland
                    

### life expectancy SD & Var

```{r}
 gapminder %>%
  filter(country %in% c("Ireland", "Switzerland")) %>%
  group_by(country) %>%
  summarise(
    sd_lifeExp = sd(lifeExp, na.rm = TRUE),
    var_lifeExp = var(lifeExp, na.rm = TRUE))
```

### T-test

```{r}
gapminder %>%
  filter(country %in% c("Ireland", "Switzerland")) %>%
  t.test(lifeExp~ country, data = .,
         alternative = "less",
         conf.level=0.95)
```
### Reflection

P-Value Analysis: The p-value of 0.05835 is slightly above the standard alpha level of 0.05. This suggests that the evidence against the null hypothesis is not strong enough to reject it at the 5% significance level. In other words, the data does not provide sufficient evidence to conclude that the mean life expectancy in Ireland is not less than in Switzerland.

Confidence Interval: The 95% confidence interval for the difference in means ranges from negative infinity to 0.1313697. Since the interval includes values both less than and greater than zero, it indicates uncertainty about the true direction of the difference in mean life expectancies.

Effect Size and Practical Significance: While statistical significance is marginal, it's also important to consider the effect size and practical significance. The mean life expectancy in Ireland is 73.01725, and in Switzerland, it is 75.56508. The difference, though statistically uncertain, might still be practically significant in terms of public health planning and policy.

Variability in Life Expectancy: The slightly higher variance and standard deviation in Switzerland suggest more variability in life expectancy compared to Ireland. This aspect could be explored further to understand the factors contributing to this variability.

## Paired T-Test

### Assumptions

Paired Observations: The data must consist of matched pairs — in this case, life expectancy values in African countries in 1957 paired with their corresponding values in 2007.

Normality of Differences: The differences in life expectancy between the two years (2007 - 1957) for each African country is approximately normally distributed.

Independence of Pairs: Each pair (country’s life expectancy in 1957 and 2007) is independent of the other pairs.

Scale of Measurement: The life expectancy is measured on an interval or ratio scale.

Random Sampling: The African countries included does represent a random sample of a larger population.

### Density Plot

```{r}

gapminder %>%
  filter(continent == "Africa" & (year == 1957 | year == 2007)) %>%
  ggplot(mapping = aes(x = lifeExp, color = factor(year), fill = factor(year))) +
  geom_density(alpha = 0.2) +
  theme_bw() +
  labs(color = "Year", fill = "Year")+labs(title = "Life Expectancy in Africa", x = "Life Expectancy", y = "Density")
```

### Hypothesis


H0: The mean life expectancy of Africa in 1957 is not same as Africa in 2007

H1: The mean life expectancy of Africa in 1957 is same as Africa in 2007
                    

### life expectancy SD & Var:

```{r}
 gapminder %>%
  filter(continent == "Africa" & (year == 1957 | year == 2007)) %>%
  group_by(year) %>%
  summarise(
    sd_lifeExp = sd(lifeExp, na.rm = TRUE),
    var_lifeExp = var(lifeExp, na.rm = TRUE)
  )
```

### Paired t-test

```{r}
 gapminder %>%
  filter(year %in% c(1957,2007)& 
           continent=="Africa") %>%
  mutate(year = factor(year,levels=c(2007,1957))) %>%
  t.test(lifeExp~year,data=.,
         paired = TRUE)
```
### Reflection

P-Value Analysis: The extremely low p-value (1.308e-15) strongly suggests rejecting the null hypothesis. This indicates that there is a statistically significant difference in mean life expectancy in Africa between 1957 and 2007.

Effect Size and Confidence Interval: The confidence interval does not include 0 and the effect size (mean difference of 13.53969) is substantial. This further supports the conclusion that life expectancy in Africa has changed significantly over the 50-year period.

Increased Variability: The increase in standard deviation and variance from 1957 to 2007 suggests that the life expectancy across different countries in Africa has become more varied over time.

## Anova

### Assumptions 

Normality: The life expectancy data for each continent (Americas, Europe, Asia) is approximately normally distributed.

Homogeneity of Variances: The variances of life expectancy across these continents is similar.

Independence of Observations: The life expectancy data for each continent is independent of the others. 

Random Sampling: The data for each continent does represent a random sample from the respective continental populations.

Interval or Ratio Level Data: The life expectancy data is measured at an interval or ratio scale.

Independence of Groups: The groups (continents) is mutually exclusive.

### Mean life expectancy 

```{r }
gapdata <- gapminder %>%
  filter(year == 2007 &
           continent %in% c("Americas", "Europe", "Asia")) %>%
  select(continent, lifeExp)
```

```{r }
gapdata %>%
  group_by(continent) %>% 
  summarise(Mean_life= mean(lifeExp)) %>%
  arrange(Mean_life)
```


### Research question 

Is the life expectancy in these three continents different?

### Hypothesis

H0: Mean life expectancy is the same 
H1: Mean life expectancy is not the same

```{r}
gapminder%>%
  filter(continent %in% c("Americas", "Europe", "Asia")) %>%
  group_by(continent) %>%
  summarize(sd = sd(lifeExp, na.rm = TRUE),
            variance = var(lifeExp, na.rm = TRUE))
```


### Anova result
```{r }
gapdata  %>%
  aov(lifeExp~continent, data=.) %>%
  summary()
 
```
The F-value is 11.63, and the p-value is extremely low (3.42e-05), which is much less than the typical alpha level of 0.05.
These results suggest that at least one continent has a mean life expectancy that is



### Tukey comparison

```{r }
gapdata  %>%
  aov(lifeExp~continent, data=.) %>%
  TukeyHSD()
 
```

The test shows that the mean life expectancy difference between Europe and Asia is statistically significant (p = 0.0000189).
The difference between Europe and the Americas is also significant (p = 0.0279460), but the difference between Asia and the Americas is not (p = 0.1432634).


### Reflection

ANOVA Results: The significant ANOVA results indicate that not all continents have the same mean life expectancy. This strongly suggests rejecting the null hypothesis (H0).

Tukey's HSD Test Insights:

The significant difference in life expectancy between Europe and Asia, as well as Europe and the Americas, implies that Europe tends to have a higher life expectancy compared to the other two continents.
The lack of a significant difference between Asia and the Americas suggests that their life expectancies are more comparable.
Variability within Continents: The standard deviation and variance within each continent  would give insights into how life expectancy varies within each continent, which is also important for understanding the overall health and development patterns.

## Linear regression

### Scatter Plot

```{r message=FALSE, warning=FALSE}
ggplot(gapminder, aes(x = gdpPercap, y = lifeExp)) +
  geom_point(color = "#89CFF0") +
  geom_smooth(method = "lm", color = "red") +  # Adding a linear regression line
  facet_wrap(~ continent) +
  labs(title = "Scatter Plot of Life Expectancy vs GDP per Capita by Continent with Regression Line",
       x = "GDP per Capita",
       y = "Life Expectancy") +
  theme_minimal()
``` 



### Scatter Plot(EU)

```{r message=FALSE, warning=FALSE}
ggplot(gapminder %>% filter(continent %in% c("Europe")), 
       aes(x = gdpPercap, y = lifeExp)) +
  geom_point(color = "#89CFF0") +
  geom_smooth(method = "lm", color = "red") +
  facet_wrap(~ continent) +
  labs(title = "Life Expectancy vs GDP per Capita in Europe",
       x = "GDP per Capita", y = "Life Expectancy") +
  theme_minimal()
```


### Hypothesis

H0: There is no relationship between life expectancy and GDP per capita in the European Union (EU).

H1: There is a relationship between life expectancy and GDP per capita in the EU.

### Linear model result

```{r }
europe_data <- gapminder[gapminder$continent == "Europe", ]
lm_model_europe <- lm(gdpPercap ~ lifeExp, data = europe_data)
summary(lm_model_europe)
```

### Reflection

Statistical Significance: The highly significant p-values for the coefficient of lifeExp and the F-statistic strongly suggest rejecting the null hypothesis. There appears to be a statistically significant relationship between life expectancy and GDP per capita in the EU.

Positive Relationship: The positive coefficient for lifeExp indicates that as life expectancy increases, GDP per capita also tends to increase. This suggests that higher life expectancy in EU countries is associated with higher economic performance.

Model Fit: While the R-squared value is reasonably high, suggesting a good model fit, it's important to note that about 39% of the variance is still unexplained by the model. This indicates that other factors, in addition to life expectancy, also play a significant role in determining GDP per capita.

